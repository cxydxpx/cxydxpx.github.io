<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>百度地图，定位及移动定位 | Mushan-Yun</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="生活不止眼前的苟且，眼前更苟且…">
<meta property="og:type" content="article">
<meta property="og:title" content="百度地图，定位及移动定位">
<meta property="og:url" content="http://cxydxpx/github.io/2017/10/26/来自百度的坑逼/index.html">
<meta property="og:site_name" content="Mushan-Yun">
<meta property="og:description" content="生活不止眼前的苟且，眼前更苟且…">
<meta property="og:image" content="https://raw.githubusercontent.com/cxydxpx/ImageRepository/master/BaiduMap/%5B%248HLBTYX%25P9%60%5DP_%5D4A%7D%25%5BD.png">
<meta property="og:updated_time" content="2018-01-19T03:37:31.705Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="百度地图，定位及移动定位">
<meta name="twitter:description" content="生活不止眼前的苟且，眼前更苟且…">
<meta name="twitter:image" content="https://raw.githubusercontent.com/cxydxpx/ImageRepository/master/BaiduMap/%5B%248HLBTYX%25P9%60%5DP_%5D4A%7D%25%5BD.png">
  
    <link rel="alternate" href="/atom.xml" title="Mushan-Yun" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Mushan-Yun</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">A small man&#39;s vast journey</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://cxydxpx/github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-来自百度的坑逼" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/10/26/来自百度的坑逼/" class="article-date">
  <time datetime="2017-10-26T11:05:39.000Z" itemprop="datePublished">2017-10-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      百度地图，定位及移动定位
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>生活不止眼前的苟且，眼前更苟且…</p>
</blockquote>
<a id="more"></a>
<p>以前是没有写博客的习惯的， 一般记个笔记已经很厉害了， 但太多大牛讲说，博客第一可以让你用来回忆以前做过的东西，也可以给别人看带来一些参考价值，并且可以给你提一些也许没发现的bug，所以还是慢慢开始写博客吧。</p>
<h3 id="重点-配置三大基本要素"><a href="#重点-配置三大基本要素" class="headerlink" title="重点  配置三大基本要素"></a>重点  配置三大基本要素</h3><ul>
<li>包名</li>
<li>AK</li>
<li>签名</li>
</ul>
<h1 id="1"><a href="#1" class="headerlink" title="1."></a>1.</h1><p>百度地图第一次在项目里用到，搜相似的文章，看官方文档，摸摸索索搞了一个多礼拜，终于初具规模了</p>
<ul>
<li>这篇文章主要要点在于移动定位，百度地图的接入及定位参考百度地图demo<a href="http://lbsyun.baidu.com/index.php?title=%E9%A6%96%E9%A1%B5" target="_blank" rel="external">百度地图</a></li>
<li>(注意 SDK下载为全量定位，基础定图，检索功能)</li>
</ul>
<p>如图：</p>
<p><img src="https://raw.githubusercontent.com/cxydxpx/ImageRepository/master/BaiduMap/%5B%248HLBTYX%25P9%60%5DP_%5D4A%7D%25%5BD.png" alt="地图"></p>
<blockquote>
<p>这其中，很多很多的坑，一步一步的踩下去，慢慢就习惯了</p>
</blockquote>
<h1 id="2"><a href="#2" class="headerlink" title="2."></a>2.</h1><p><strong>核心类 方法</strong></p>
<ul>
<li><p>GeoCoder</p>
<p>mGeoCode.reverseGeCoder(ReverseGeoOption)</p>
<p>mGeoCode.setOnGetGeoResultListener(mOnGetGeoCoderResultListener)</p>
</li>
<li><p>OnGetGeoCoderResultListener</p>
<p>onGetGeoCoderResult(ReverseGeoCodeResult result)</p>
</li>
<li><p>OnMapStatusChangeListener</p>
<p>onMapStatusChangeFinish(MapStatus status);</p>
</li>
</ul>
<h1 id="3"><a href="#3" class="headerlink" title="3."></a>3.</h1><h3 id="代码范例"><a href="#代码范例" class="headerlink" title="代码范例"></a>代码范例</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">public class MapActivity extends AppCompatActivity implements OnGetGeoCoderResultListener, BaiduMap.OnMapStatusChangeListener &#123;</div><div class="line"></div><div class="line">    private TextureMapView mMapView;</div><div class="line"></div><div class="line">    private BaiduMap mBaiduMap;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * 初始化LocationClient 定位端</div><div class="line">     */</div><div class="line">    public LocationClient mLocationClient = null;</div><div class="line">    /**</div><div class="line">     * 定位坐标</div><div class="line">     */</div><div class="line">    private LatLng locationLatLng;</div><div class="line">    /**</div><div class="line">     * 定位城市</div><div class="line">     */</div><div class="line">    private String city;</div><div class="line">    /**</div><div class="line">     * 反地理编码</div><div class="line">     */</div><div class="line">    private GeoCoder mSearch;</div><div class="line"></div><div class="line">    private HelpeLocation mHepleLocation;</div><div class="line">    private BDAbstractLocationListener mListener;</div><div class="line"></div><div class="line">    @BindView(R.id.main_pois)</div><div class="line">    ListView mListView;</div><div class="line"></div><div class="line">    private boolean mIsFirstLoc = true;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * 定位模式</div><div class="line">     */</div><div class="line">    private MyLocationConfiguration.LocationMode mCurrentMode;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    protected void onCreate(@Nullable Bundle savedInstanceState) &#123;</div><div class="line">        super.onCreate(savedInstanceState);</div><div class="line">        //SDK初始化操作一定要放在activity的setContentView()方法前面</div><div class="line">        SDKInitializer.initialize(getApplicationContext());</div><div class="line">        setContentView(R.layout.activity_map);</div><div class="line">        ButterKnife.bind(this);</div><div class="line"></div><div class="line">        //获取地图控件引用</div><div class="line">        mMapView = (TextureMapView) findViewById(R.id.main_bdmap);</div><div class="line">        mBaiduMap = mMapView.getMap();</div><div class="line">//        普通地图</div><div class="line">        mBaiduMap.setMapType(BaiduMap.MAP_TYPE_NORMAL);</div><div class="line"></div><div class="line">        //定义地图状态 改变地图缩放等级</div><div class="line">        MapStatus mMapStatus = new MapStatus.Builder().zoom(18).build();</div><div class="line">        MapStatusUpdate mMapStatusUpdate = MapStatusUpdateFactory.newMapStatus(mMapStatus);</div><div class="line"></div><div class="line">//        直接设置地图状态  设置地图显示范围</div><div class="line">//        mBaiduMap.setMapStatus(mMapStatusUpdate);</div><div class="line">//        采用动画的方式设置地图状态   设置地图显示范围</div><div class="line">        mBaiduMap.animateMapStatus(mMapStatusUpdate);</div><div class="line"></div><div class="line">        //地图状态改变相关监听</div><div class="line">        mBaiduMap.setOnMapStatusChangeListener(this);</div><div class="line"></div><div class="line">        // 开启定位图层</div><div class="line">        mBaiduMap.setMyLocationEnabled(true);</div><div class="line"></div><div class="line">        // 设置定位图层的配置（定位模式，是否允许方向信息，用户自定义定位图标）</div><div class="line">        mCurrentMode = MyLocationConfiguration.LocationMode.NORMAL;</div><div class="line">        MyLocationConfiguration config = new MyLocationConfiguration(mCurrentMode, true, null);</div><div class="line">        mBaiduMap.setMyLocationConfiguration(config);</div><div class="line"></div><div class="line">        mListener = new MyLocationListener();</div><div class="line">        mHepleLocation = ((IApplication) getApplication()).locationService;</div><div class="line"></div><div class="line">        // /获取locationservice实例，建议应用中只初始化1个location实例，然后使用，可以参考其他示例的activity，都是通过此种方式获取locationservice实例的</div><div class="line">        mHepleLocation.registerListener(mListener);</div><div class="line"></div><div class="line">        SimpleRuntimePermissionHelper.with(new SimpleRuntimePermission(MapActivity.this))</div><div class="line">                .permission(Manifest.permission.ACCESS_FINE_LOCATION)</div><div class="line">                .execute(new SimpleRuntimePermission.PermissionListener() &#123;</div><div class="line">                    @Override</div><div class="line">                    public void onAllPermissionGranted() &#123;</div><div class="line">                        mHepleLocation.start();</div><div class="line">                    &#125;</div><div class="line"></div><div class="line">                    @Override</div><div class="line">                    public void onPermissionRefuse(PermissionRefuseResultHelper resultHelper) &#123;</div><div class="line"></div><div class="line">                    &#125;</div><div class="line">                &#125;);</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    protected void onStart() &#123;</div><div class="line">        super.onStart();</div><div class="line">// -----------location config ------------</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    protected void onResume() &#123;</div><div class="line">        super.onResume();</div><div class="line">        //在activity执行onResume时执行mMapView. onResume ()，实现地图生命周期管理</div><div class="line">        mMapView.onResume();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    protected void onPause() &#123;</div><div class="line">        super.onPause();</div><div class="line">        //在activity执行onPause时执行mMapView. onPause ()，实现地图生命周期管理</div><div class="line">        mMapView.onPause();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * 地理编码查询结果回调函数</div><div class="line">     *</div><div class="line">     * @param result</div><div class="line">     */</div><div class="line">    @Override</div><div class="line">    public void onGetGeoCodeResult(GeoCodeResult result) &#123;</div><div class="line"></div><div class="line">        if (result == null || result.error != SearchResult.ERRORNO.NO_ERROR) &#123;</div><div class="line">            //没有检索到结果</div><div class="line">        &#125;</div><div class="line">        //获取地理编码结果</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * 反地理编码查询结果回调函数</div><div class="line">     *</div><div class="line">     * @param result</div><div class="line">     */</div><div class="line">    @Override</div><div class="line">    public void onGetReverseGeoCodeResult(ReverseGeoCodeResult result) &#123;</div><div class="line"></div><div class="line">        if (result == null || result.error != SearchResult.ERRORNO.NO_ERROR) &#123;</div><div class="line">            //没有检索到结果</div><div class="line">        &#125; else &#123;</div><div class="line">            final List&lt;PoiInfo&gt; poiInfos = result.getPoiList();</div><div class="line">            MapAdapter poiAdapter = new MapAdapter(MapActivity.this, poiInfos);</div><div class="line">            mListView.setAdapter(poiAdapter);</div><div class="line"></div><div class="line">            mListView.setOnItemClickListener(new AdapterView.OnItemClickListener() &#123;</div><div class="line">                @Override</div><div class="line">                public void onItemClick(AdapterView&lt;?&gt; parent, View view, int position, long id) &#123;</div><div class="line">                    PoiInfo info = poiInfos.get(position);</div><div class="line">                    Toast.makeText(MapActivity.this, info.name, Toast.LENGTH_SHORT).show();</div><div class="line">                    finish();</div><div class="line">                &#125;</div><div class="line">            &#125;);</div><div class="line"></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * 手势操作地图，设置地图状态等操作导致地图状态开始改变。</div><div class="line">     *</div><div class="line">     * @param status 地图状态改变开始时的地图状态</div><div class="line">     */</div><div class="line">    @Override</div><div class="line">    public void onMapStatusChangeStart(MapStatus status) &#123;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * 因某种操作导致地图状态开始改变。</div><div class="line">     *</div><div class="line">     * @param status 地图状态改变开始时的地图状态</div><div class="line">     * @param i      reason表示地图状态改变的原因，取值有：</div><div class="line">     *               1：用户手势触发导致的地图状态改变,比如双击、拖拽、滑动底图</div><div class="line">     *               2：SDK导致的地图状态改变, 比如点击缩放控件、指南针图标</div><div class="line">     *               3：开发者调用,导致的地图状态改变</div><div class="line">     */</div><div class="line">    @Override</div><div class="line">    public void onMapStatusChangeStart(MapStatus status, int i) &#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * 地图状态变化中</div><div class="line">     *</div><div class="line">     * @param status 当前地图状态</div><div class="line">     */</div><div class="line">    @Override</div><div class="line">    public void onMapStatusChange(MapStatus status) &#123;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * 地图状态改变结束</div><div class="line">     *</div><div class="line">     * @param status 地图状态改变结束后的地图状态</div><div class="line">     */</div><div class="line">    @Override</div><div class="line">    public void onMapStatusChangeFinish(MapStatus status) &#123;</div><div class="line">        //地图操作的中心点</div><div class="line">        LatLng cenpt = status.target;</div><div class="line">//      发起地理编码检索</div><div class="line">        mSearch.reverseGeoCode(new ReverseGeoCodeOption().location(cenpt));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * 位置监听器</div><div class="line">     * BDLocationListener接口有1个方法需要实现： 1.接收异步返回的定位结果，参数是BDLocation类型参数。</div><div class="line">     */</div><div class="line">    class MyLocationListener extends BDAbstractLocationListener &#123;</div><div class="line">        /**</div><div class="line">         * 接收位置的信息回调方法</div><div class="line">         *</div><div class="line">         * @param location</div><div class="line">         */</div><div class="line">        @Override</div><div class="line">        public void onReceiveLocation(BDLocation location) &#123; // de</div><div class="line"></div><div class="line">            if (location == null) &#123;</div><div class="line">                return;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            // 构造定位数据</div><div class="line">            MyLocationData locData = new MyLocationData.Builder()</div><div class="line">                    //定位精度bdLocation.getRadius()</div><div class="line">                    .accuracy(location.getRadius())</div><div class="line">                    // 此处设置开发者获取到的方向信息，顺时针0-360</div><div class="line">                    .direction(location.getDirection())</div><div class="line">                    //经度</div><div class="line">                    .latitude(location.getLatitude())</div><div class="line">                    //纬度</div><div class="line">                    .longitude(location.getLongitude())</div><div class="line">                    .build();</div><div class="line">            // 设置定位数据</div><div class="line">            mBaiduMap.setMyLocationData(locData);</div><div class="line"></div><div class="line">            //是否是第一次定位</div><div class="line">            if (mIsFirstLoc) &#123;</div><div class="line">                mIsFirstLoc = false;</div><div class="line"></div><div class="line">                LatLng cenpt = new LatLng(location.getLatitude(), location.getLongitude());</div><div class="line">                //定义地图状态</div><div class="line">                MapStatus mMapStatus = new MapStatus.Builder()</div><div class="line">                        .target(cenpt)</div><div class="line">                        .build();</div><div class="line">                //定义MapStatusUpdate对象，以便描述地图状态将要发生的变化</div><div class="line">                MapStatusUpdate mMapStatusUpdate = MapStatusUpdateFactory.newMapStatus(mMapStatus);</div><div class="line">                //改变地图状态</div><div class="line">                mBaiduMap.setMapStatus(mMapStatusUpdate);</div><div class="line"></div><div class="line">            &#125;</div><div class="line"></div><div class="line">            //获取坐标，待会用于POI信息点与定位的距离</div><div class="line">            locationLatLng = new LatLng(location.getLatitude(), location.getLongitude());</div><div class="line">            //获取城市，待会用于POISearch</div><div class="line">            city = location.getCity();</div><div class="line"></div><div class="line">            //创建地理编码检索实例</div><div class="line">            mSearch = GeoCoder.newInstance();</div><div class="line">            //发起反地理编码请求(经纬度-&gt;地址信息)</div><div class="line">            ReverseGeoCodeOption reverseGeoCodeOption = new ReverseGeoCodeOption();</div><div class="line">            //设置反地理编码位置坐标</div><div class="line">            reverseGeoCodeOption.location(new LatLng(location.getLatitude(), location.getLongitude()));</div><div class="line">//            发起地理编码检索</div><div class="line">            mSearch.reverseGeoCode(reverseGeoCodeOption);</div><div class="line"></div><div class="line">            //设置查询结果监听者  地理编码检索监听者</div><div class="line">            mSearch.setOnGetGeoCodeResultListener(MapActivity.this);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    @Override</div><div class="line">    protected void onDestroy() &#123;</div><div class="line">        super.onDestroy();</div><div class="line">        //在activity执行onDestroy时执行mMapView.onDestroy()，实现地图生命周期管理</div><div class="line">        mMapView.onDestroy();</div><div class="line"></div><div class="line">        //退出时停止定位</div><div class="line">        mHepleLocation.stop();</div><div class="line">        //退出时关闭定位图层</div><div class="line">        mBaiduMap.setMyLocationEnabled(false);</div><div class="line"></div><div class="line">        // activity 销毁时同时销毁地图控件</div><div class="line">        mMapView.onDestroy();</div><div class="line"></div><div class="line">        //释放资源</div><div class="line">        if (mSearch != null) &#123;</div><div class="line">            mSearch.destroy();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        mMapView = null;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="4"><a href="#4" class="headerlink" title="4."></a>4.</h1><h3 id="中心思想："><a href="#中心思想：" class="headerlink" title="中心思想："></a>中心思想：</h3><ul>
<li>在onCreate()方法里 初始化MapView，由 mMapView.getMap()获取BaiduMap对象（大部分操作由BaiduMap对象操作）</li>
<li>使用mBaiduMap对象地图类型 </li>
<li>定义地图缩放等级 设置地图缩放范围</li>
<li>设置地图状态监听 开启层图</li>
<li>创建位置监听器 接收位置信息的回调方法</li>
<li>在回调方法里 设置定位数据 根据定位数据 来设置地图状态将要发生的变化</li>
<li>创建地理编码检索实例 发起地理编码检索 设置编码检索监听者</li>
</ul>
<h1 id="Github"><a href="#Github" class="headerlink" title="Github"></a>Github</h1><ul>
<li>项目Github地址：<a href="https://github.com/cxydxpx/APEN_DEMO" target="_blank" rel="external">https://github.com/cxydxpx/APEN_DEMO</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://cxydxpx/github.io/2017/10/26/来自百度的坑逼/" data-id="cjcldkeqn0008v0981wt493y3" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2017/10/30/android-picture-problem/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          android picture problem
        
      </div>
    </a>
  
  
    <a href="/2017/10/26/hexo/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">hexo</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/12/15/Retrofit/">Retrofit源码解读</a>
          </li>
        
          <li>
            <a href="/2017/12/15/Rxjava/">Rxjava源码解读</a>
          </li>
        
          <li>
            <a href="/2017/12/15/Glide/">Glide源码解读</a>
          </li>
        
          <li>
            <a href="/2017/11/28/CostomView/">自定义View</a>
          </li>
        
          <li>
            <a href="/2017/10/31/Config-Build/">配置构建</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 MushanYun<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>